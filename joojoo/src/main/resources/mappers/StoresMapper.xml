<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="joojoo.mappers.StoresMapper">


	<insert id="insertStore" parameterType="Stores">
		insert into stores (store_name, store_adress, store_phone , owner_id, region_code,type_code)
		values(#{storeName}, #{storeAdress}, #{storePhone}, #{ownerId},#{regionCode},#{typeCode})
	</insert>
  
  	<update id="updateStore" parameterType="Stores">
  	
  	update stores
  	set store_name = #{storeName},
  		store_adress=#{storeAdress},
  		store_phone=#{storePhone},
  		owner_id = #{ownerId},
  		region_code = #{regionCode},
  		type_code = #{typeCode},
  		star_point = #{starPoint}
  	where store_code=#{storeCode}  	
  	
  	</update>
  	
  	<delete id="deleteStore" parameterType="Integer">
  	delete from stores
  	where store_code=#{storeCode}
  	</delete>
  	
  	<select id = "getStoresByOwnerId" resultType="Stores">
	select *
	from stores
	where owner_id=#{ownerId}
	</select>
  	
  	<select id = "getStoreByStoreCode" resultType="Stores">
	select *
	from stores
	where store_code=#{storeCode}
	
	</select>
	
	<select id = "getStoresByStoreType" resultType="Stores">
	select *
	from stores
	where type_code=#{typeCode}
	
	</select>
	
	<select id = "getStoresByRegion" resultType="Stores">
	select *
	from stores
	where region_code=#{regionCode}
	
	</select>
	
	<select id="getStoresByCategory"  resultType="Stores">
 	 SELECT * FROM stores
  <where> 
    <if test="regionCode != 0">
         region_code=#{regionCode}
    </if> 
    <if test="typeCode != 0">
        and type_code=#{typeCode}
    </if>
  </where>
</select>


	
	<select id= "getStoresBySearchKeyword" resultType="Stores">
		select * 
		from stores s 
		join store_type t on(s.type_code = t.type_code)
		join region r on (r.region_code = s.region_code)
		
		where r.region_name like '%${keyword}%'
		or t.type_name like '%${keyword}%'
		or s.store_name like '%${keyword}%'
		or s.store_phone like '%${keyword}%'
		or s.store_adress like '%${keyword}%'
		
	</select>
	
	
  
</mapper>
